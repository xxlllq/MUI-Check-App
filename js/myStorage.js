(function(win,com,mui){var myStorage={};function getItem(k){var jsonStr=window.localStorage.getItem(k.toString());return jsonStr?JSON.parse(jsonStr).data:null}function getItemPlus(k){var jsonStr=plus.storage.getItem(k.toString());return jsonStr?JSON.parse(jsonStr).data:null}myStorage.getItem=function(k){return getItem(k)||getItemPlus(k)};myStorage.setItem=function(k,value){value=JSON.stringify({data:value});k=k.toString();try{window.localStorage.setItem(k,value)}catch(e){console.log(e);removeItem(k);plus.storage.setItem(k,value)}};function getLength(){return window.localStorage.length}myStorage.getLength=getLength;function getLengthPlus(){return plus.storage.getLength()}myStorage.getLengthPlus=getLengthPlus;function removeItem(k){return window.localStorage.removeItem(k)}function removeItemPlus(k){return plus.storage.removeItem(k)}myStorage.removeItem=function(k){window.localStorage.removeItem(k);return plus.storage.removeItem(k)};myStorage.clear=function(){window.localStorage.clear();return plus.storage.clear()};function key(index){return window.localStorage.key(index)}myStorage.key=key;function keyPlus(index){return plus.storage.key(index)}myStorage.keyPlus=keyPlus;function getItemByIndex(index){var item={keyname:"",keyvalue:""};item.keyname=key(index);item.keyvalue=getItem(item.keyname);return item}myStorage.getItemByIndex=getItemByIndex;function getItemByIndexPlus(index){var item={keyname:"",keyvalue:""};item.keyname=keyPlus(index);item.keyvalue=getItemPlus(item.keyname);return item}myStorage.getItemByIndexPlus=getItemByIndexPlus;myStorage.getItems=function(k){var items=[];var numKeys=getLength();var numKeysPlus=getLengthPlus();var i=0;if(k){for(;i<numKeys;i++){if(key(i).toString().indexOf(k)!=-1){items.push(getItemByIndex(i))}}for(i=0;i<numKeysPlus;i++){if(keyPlus(i).toString().indexOf(k)!=-1){items.push(getItemByIndexPlus(i))}}}else{for(i=0;i<numKeys;i++){items.push(getItemByIndex(i))}for(i=0;i<numKeysPlus;i++){items.push(getItemByIndexPlus(i))}}return items};myStorage.removeItemByKeys=function(keys,cb){if(typeof(keys)==="string"){keys=[keys]}var numKeys=getLength();var numKeysPlus=getLengthPlus();var tmpks=[];var tk,i=numKeys-1;for(;i>=0;i--){tk=key(i);Array.prototype.forEach.call(keys,function(k,index,arr){if(tk.toString().indexOf(k)!=-1){tmpks.push(tk)}})}tmpks.forEach(function(k){removeItem(k)});for(i=numKeysPlus-1;i>=0;i--){tk=keyPlus(i);Array.prototype.forEach.call(keys,function(k,index,arr){if(tk.toString().indexOf(k)!=-1){tmpks.push(tk)}})}tmpks.forEach(function(k){removeItemPlus(k)});cb&&cb()};com.myStorage=myStorage;win.myStorage=myStorage}(window,common,mui));